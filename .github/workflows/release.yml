name: Release (cz bump)


on:
push:
branches: [ "main" ]


jobs:
release:
runs-on: ubuntu-latest
permissions:
contents: write
steps:
- uses: actions/checkout@v4
with:
fetch-depth: 0


- uses: actions/setup-python@v5
with:
python-version: "3.13"


- uses: abatilo/actions-poetry@v3
with:
poetry-version: "1.8.3"


- name: Install deps
run: |
poetry install --no-interaction
poetry run pre-commit run --all-files


- name: Conventional bump (Commitizen)
env:
GIT_AUTHOR_NAME: "github-actions[bot]"
GIT_AUTHOR_EMAIL: "41898282+github-actions[bot]@users.noreply.github.com"
GIT_COMMITTER_NAME: "github-actions[bot]"
GIT_COMMITTER_EMAIL: "41898282+github-actions[bot]@users.noreply.github.com"
run: |
poetry run cz bump --yes --changelog
git push
git push --tags


- name: Create GitHub Release from latest tag
uses: softprops/action-gh-release@v2
with:
generate_release_notes: true